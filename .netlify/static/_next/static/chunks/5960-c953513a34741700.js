"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5960],{23395:(e,t,a)=>{a.d(t,{ND:()=>o});var s=a(23171);let i="https://molcqjsqtjbfclasynpg.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1vbGNxanNxdGpiZmNsYXN5bnBnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODk1NDcsImV4cCI6MjA3MTQ2NTU0N30.IEP7E2VM2uV1vltbSw1CwYpYw1qw6MvI-JB5SD0tUKI";if(!i||!r)throw Error("Missing Supabase environment variables. Please check NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY");let o=(0,s.UU)(i,r,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})},35960:(e,t,a)=>{a.d(t,{M:()=>F});var s=a(95155),i=a(12115),r=a(19114),o=a(38274),n=a(57434),c=a(66516),l=a(54416),d=a(14186),p=a(17580),g=a(24357),h=a(99890),u=a(54213),m=a(65112),f=a(51154),y=a(91788),P=a(66474),x=a(89258),b=a(49509);let C={github:x.YjP().regex(/^github_pat_[A-Za-z0-9_]+$/,"Invalid GitHub token format"),stripe:x.YjP().regex(/^rk_(live|test)_[A-Za-z0-9_]+$/,"Invalid Stripe key format"),anthropic:x.YjP().regex(/^sk-ant-api03-[A-Za-z0-9_-]+$/,"Invalid Anthropic API key format"),supabase:x.YjP().regex(/^eyJ[A-Za-z0-9_-]+$/,"Invalid Supabase JWT format"),airtable:x.YjP().regex(/^pat[A-Za-z0-9_.]+$/,"Invalid Airtable API key format"),netlify:x.YjP().regex(/^nfp_[A-Za-z0-9_]+$/,"Invalid Netlify API key format"),render:x.YjP().regex(/^rnd_[A-Za-z0-9_]+$/,"Invalid Render API key format"),google:x.YjP().regex(/^[0-9]+-[A-Za-z0-9_.]+\.apps\.googleusercontent\.com$/,"Invalid Google Client ID format")},v=x.Ikc({NODE_ENV:x.k5n(["development","production","test"]).catch("development"),NEXT_PUBLIC_SITE_URL:x.YjP().url().catch("http://localhost:3000"),NEXT_PUBLIC_GITHUB_TOKEN:x.YjP().optional().or(x.euz("")),NEXT_PUBLIC_STRIPE_TOKEN:x.YjP().optional().or(x.euz("")),ANTHROPIC_API_KEY:x.YjP().optional().or(x.euz("")),NEXT_PUBLIC_ANTHROPIC_API_KEY:x.YjP().optional().or(x.euz("")),NEXT_PUBLIC_SUPABASE_URL:x.YjP().optional().or(x.euz("")),NEXT_PUBLIC_SUPABASE_ANON_KEY:x.YjP().optional().or(x.euz("")),SUPABASE_SERVICE_ROLE_KEY:x.YjP().optional().or(x.euz("")),NEXT_PUBLIC_AIRTABLE_API_KEY:x.YjP().optional().or(x.euz("")),NEXT_PUBLIC_AIRTABLE_BASE_ID:x.YjP().optional().or(x.euz("")),NEXT_PUBLIC_GOOGLE_CLIENT_ID:x.YjP().optional().or(x.euz("")),GOOGLE_CLIENT_SECRET:x.YjP().optional().or(x.euz("")),NEXT_PUBLIC_NETLIFY_API_KEY:x.YjP().optional().or(x.euz("")),NEXT_PUBLIC_RENDER_SERVICE_ID:x.YjP().optional().or(x.euz("")),NEXT_PUBLIC_RENDER_URL:x.YjP().optional().or(x.euz("")),RENDER_API_KEY:x.YjP().optional().or(x.euz("")),BACKEND_API_KEY:x.YjP().optional().or(x.euz(""))}),_={development:{apiKeys:{stripe:{useTestKey:!0,testKeyPrefix:"rk_test_",liveKeyPrefix:"rk_live_"},anthropic:{rateLimit:100,timeout:3e4},github:{rateLimit:5e3,timeout:1e4}},security:{cors:{origin:["http://localhost:3000","http://localhost:3002"],credentials:!0},headers:{"X-Content-Type-Options":"nosniff","X-Frame-Options":"SAMEORIGIN","X-XSS-Protection":"1; mode=block","Referrer-Policy":"strict-origin-when-cross-origin"}},logging:{level:"debug",enableRequestLogging:!0,enableErrorLogging:!0}},production:{apiKeys:{stripe:{useTestKey:!1,testKeyPrefix:"rk_test_",liveKeyPrefix:"rk_live_"},anthropic:{rateLimit:1e3,timeout:6e4},github:{rateLimit:5e3,timeout:15e3}},security:{cors:{origin:["https://platform.andruai.com"],credentials:!0},headers:{"X-Content-Type-Options":"nosniff","X-Frame-Options":"DENY","X-XSS-Protection":"1; mode=block","Referrer-Policy":"strict-origin-when-cross-origin","Content-Security-Policy":"default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';"}},logging:{level:"info",enableRequestLogging:!1,enableErrorLogging:!0}},test:{apiKeys:{stripe:{useTestKey:!0,testKeyPrefix:"rk_test_",liveKeyPrefix:"rk_live_"},anthropic:{rateLimit:10,timeout:5e3},github:{rateLimit:100,timeout:5e3}},security:{cors:{origin:["http://localhost:3000"],credentials:!0},headers:{"X-Content-Type-Options":"nosniff","X-Frame-Options":"SAMEORIGIN","X-XSS-Protection":"1; mode=block","Referrer-Policy":"strict-origin-when-cross-origin"}},logging:{level:"error",enableRequestLogging:!1,enableErrorLogging:!0}}};class E{static getInstance(){return E.instance||(E.instance=new E),E.instance}detectEnvironment(){let e="production";return e&&["development","production","test"].includes(e)?e:(console.warn("Invalid NODE_ENV, defaulting to development"),"development")}loadAndValidateConfig(){try{let e=v.parse(b.env);return this.validateEnvironmentSpecificConfig(e),e}catch(e){if(e instanceof x.GaX)throw console.error("Environment validation failed:"),e.issues.forEach(e=>{console.error("  ".concat(e.path.join("."),": ").concat(e.message))}),Error("Environment configuration validation failed");throw e}}validateEnvironmentSpecificConfig(e){let t=_[this.environment];e.NEXT_PUBLIC_STRIPE_TOKEN&&(t.apiKeys.stripe.useTestKey?e.NEXT_PUBLIC_STRIPE_TOKEN.startsWith("rk_test_")||console.warn("Warning: Using live Stripe key in ".concat(this.environment," environment. Consider using test key.")):e.NEXT_PUBLIC_STRIPE_TOKEN.startsWith("rk_live_")||console.warn("Warning: Production environment should use live Stripe key, got: ".concat(e.NEXT_PUBLIC_STRIPE_TOKEN.substring(0,10),"...")))}get environment(){return this._environment}get isDevelopment(){return"development"===this._environment}get isProduction(){return"production"===this.environment}get isTest(){return"test"===this.environment}get config(){return this._config}get environmentConfig(){return _[this.environment]}get githubToken(){return this._config.NEXT_PUBLIC_GITHUB_TOKEN}get stripeToken(){return this._config.NEXT_PUBLIC_STRIPE_TOKEN}get anthropicApiKey(){return this._config.ANTHROPIC_API_KEY||this._config.NEXT_PUBLIC_ANTHROPIC_API_KEY}get supabaseUrl(){return this._config.NEXT_PUBLIC_SUPABASE_URL}get supabaseAnonKey(){return this._config.NEXT_PUBLIC_SUPABASE_ANON_KEY}get supabaseServiceRoleKey(){return this._config.SUPABASE_SERVICE_ROLE_KEY}get airtableApiKey(){return this._config.NEXT_PUBLIC_AIRTABLE_API_KEY}get airtableBaseId(){return this._config.NEXT_PUBLIC_AIRTABLE_BASE_ID}get googleClientId(){return this._config.NEXT_PUBLIC_GOOGLE_CLIENT_ID}get googleClientSecret(){return this._config.GOOGLE_CLIENT_SECRET}get netlifyApiKey(){return this._config.NEXT_PUBLIC_NETLIFY_API_KEY}get renderServiceId(){return this._config.NEXT_PUBLIC_RENDER_SERVICE_ID}get renderUrl(){return this._config.NEXT_PUBLIC_RENDER_URL}get renderApiKey(){return this._config.RENDER_API_KEY}get backendApiKey(){return this._config.BACKEND_API_KEY}get siteUrl(){return this._config.NEXT_PUBLIC_SITE_URL}validateApiKey(e,t){try{return C[t].parse(e),!0}catch(e){return!1}}getApiKeyConfig(e){return this.environmentConfig.apiKeys[e]}getSecurityConfig(){return this.environmentConfig.security}getLoggingConfig(){return this.environmentConfig.logging}constructor(){this._environment=this.detectEnvironment(),this._config=this.loadAndValidateConfig()}}let w=E.getInstance();var S=a(68542),I=a(26597),T=a(76118);class A{static async generateICPAnalysis(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new A(t);if(a.addCoverPage(t.title||"Ideal Customer Profile Analysis",t.subtitle||"Revenue Intelligence Platform"),a.addNewPage(),a.addHeading("Executive Summary",1),a.addParagraph(e.executiveSummary||"This document provides a comprehensive analysis of your Ideal Customer Profile (ICP)."),e.sections)for(let t of e.sections)a.checkPageBreak(60),a.addSection(t);if(e.buyerPersonas&&e.buyerPersonas.length>0)for(let t of(a.addNewPage(),a.addHeading("Buyer Personas",1),e.buyerPersonas))a.checkPageBreak(80),a.addBuyerPersona(t);return e.companyRatings&&e.companyRatings.length>0&&(a.addNewPage(),a.addHeading("Company Ratings",1),a.addCompanyRatingsTable(e.companyRatings)),a.addFooterToAllPages(),a.getBlob()}static async generateAssessment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new A(t);if(a.addCoverPage(t.title||"Assessment Results",t.subtitle||"Revenue Intelligence Platform"),a.addNewPage(),a.addHeading("Assessment Overview",1),a.addParagraph(e.overview||"This assessment provides insights into your revenue intelligence capabilities."),e.scores&&(a.checkPageBreak(80),a.addHeading("Competency Scores",2),a.addScoresTable(e.scores)),e.recommendations&&e.recommendations.length>0)for(let t of(a.checkPageBreak(60),a.addHeading("Recommendations",2),e.recommendations))a.addBulletPoint(t);return a.addFooterToAllPages(),a.getBlob()}static async generateBusinessCase(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new A(t);return a.addCoverPage(t.title||"Business Case",t.subtitle||e.companyName||"Revenue Intelligence Platform"),a.addNewPage(),a.addHeading("Executive Summary",1),a.addParagraph(e.executiveSummary||"This business case outlines the value proposition and ROI for your investment."),e.problemStatement&&(a.checkPageBreak(50),a.addHeading("Problem Statement",2),a.addParagraph(e.problemStatement)),e.solution&&(a.checkPageBreak(50),a.addHeading("Proposed Solution",2),a.addParagraph(e.solution)),e.financialAnalysis&&(a.checkPageBreak(80),a.addHeading("Financial Analysis",2),a.addFinancialAnalysisTable(e.financialAnalysis)),e.roiProjections&&(a.checkPageBreak(60),a.addHeading("ROI Projections",2),a.addParagraph(e.roiProjections)),a.addFooterToAllPages(),a.getBlob()}static async generateCostCalculator(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new A(t);return a.addCoverPage(t.title||"Cost of Inaction Analysis",t.subtitle||"Financial Impact Assessment"),a.addNewPage(),a.addHeading("Cost Analysis Summary",1),e.totalCost&&a.addKeyMetric("Total Cost of Inaction","$".concat(e.totalCost.toLocaleString())),e.breakdown&&(a.checkPageBreak(80),a.addHeading("Cost Breakdown",2),a.addCostBreakdownTable(e.breakdown)),e.recommendations&&(a.checkPageBreak(60),a.addHeading("Recommendations",2),a.addParagraph(e.recommendations)),a.addFooterToAllPages(),a.getBlob()}static async generateFromSections(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new A(t);for(let s of(t.title&&(a.addCoverPage(t.title,t.subtitle),a.addNewPage()),e))a.checkPageBreak(60),a.addSection(s);return a.addFooterToAllPages(),a.getBlob()}addCoverPage(e,t){this.doc.setFillColor(...this.primaryColor),this.doc.rect(0,0,this.pageWidth,this.pageHeight/3,"F"),this.doc.setFillColor(...this.secondaryColor),this.doc.rect(0,this.pageHeight/3,this.pageWidth,this.pageHeight/3,"F"),this.doc.setTextColor(255,255,255),this.doc.setFontSize(32),this.doc.setFont("helvetica","bold");let a=this.doc.splitTextToSize(e,this.pageWidth-2*this.margin);this.doc.text(a,this.pageWidth/2,this.pageHeight/2-20,{align:"center"}),t&&(this.doc.setFontSize(16),this.doc.setFont("helvetica","normal"),this.doc.text(t,this.pageWidth/2,this.pageHeight/2+10,{align:"center"})),this.doc.setFontSize(12);let s=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});this.doc.text(s,this.pageWidth/2,this.pageHeight-30,{align:"center"}),this.doc.setTextColor(0,0,0)}addNewPage(){this.doc.addPage(),this.currentY=this.margin}checkPageBreak(e){this.currentY+e>this.pageHeight-this.margin&&this.addNewPage()}addFooterToAllPages(){let e=this.doc.getNumberOfPages();for(let t=1;t<=e;t++)this.doc.setPage(t),this.doc.setDrawColor(...this.primaryColor),this.doc.setLineWidth(.5),this.doc.line(this.margin,this.pageHeight-15,this.pageWidth-this.margin,this.pageHeight-15),this.doc.setFontSize(10),this.doc.setTextColor(128,128,128),this.doc.text("Page ".concat(t," of ").concat(e),this.pageWidth/2,this.pageHeight-10,{align:"center"}),this.doc.text("Generated by Revenue Intelligence Platform",this.margin,this.pageHeight-10);this.doc.setPage(e),this.doc.setTextColor(0,0,0)}addHeading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=1===t?20:2===t?16:14,s=1===t?6:2===t?4:3;this.currentY+=1===t?10:2===t?8:6,this.checkPageBreak(a+s),this.doc.setFontSize(a),this.doc.setFont("helvetica","bold"),this.doc.setTextColor(...this.primaryColor),this.doc.text(e,this.margin,this.currentY),1===t&&(this.doc.setDrawColor(...this.primaryColor),this.doc.setLineWidth(.5),this.doc.line(this.margin,this.currentY+2,this.margin+60,this.currentY+2)),this.currentY+=s,this.doc.setTextColor(0,0,0),this.doc.setFont("helvetica","normal")}addParagraph(e){for(let t of(this.doc.setFontSize(11),this.doc.setFont("helvetica","normal"),this.doc.splitTextToSize(e,this.pageWidth-2*this.margin)))this.checkPageBreak(6),this.doc.text(t,this.margin,this.currentY),this.currentY+=6;this.currentY+=4}addBulletPoint(e){this.doc.setFontSize(11),this.checkPageBreak(6),this.doc.text("•",this.margin,this.currentY);let t=this.doc.splitTextToSize(e,this.pageWidth-2*this.margin-5);for(let e=0;e<t.length;e++)e>0&&this.checkPageBreak(6),this.doc.text(t[e],this.margin+5,this.currentY),this.currentY+=6}addKeyMetric(e,t){this.checkPageBreak(25),this.doc.setFillColor(245,247,250),this.doc.roundedRect(this.margin,this.currentY,this.pageWidth-2*this.margin,20,3,3,"F"),this.doc.setFontSize(10),this.doc.setTextColor(100,100,100),this.doc.text(e,this.margin+5,this.currentY+7),this.doc.setFontSize(16),this.doc.setFont("helvetica","bold"),this.doc.setTextColor(...this.primaryColor),this.doc.text(t,this.margin+5,this.currentY+16),this.currentY+=25,this.doc.setFont("helvetica","normal"),this.doc.setTextColor(0,0,0)}addSection(e){if(this.addHeading(e.title,2),"string"==typeof e.content)this.addParagraph(e.content);else if(Array.isArray(e.content))for(let t of e.content)this.addBulletPoint(t);"table"===e.type&&e.data&&this.addTable(e.data)}addTable(e){this.checkPageBreak(40),(0,T.Ay)(this.doc,{startY:this.currentY,head:[e.headers],body:e.rows,theme:"grid",headStyles:{fillColor:this.primaryColor,textColor:[255,255,255],fontStyle:"bold",fontSize:10},styles:{fontSize:9,cellPadding:3},alternateRowStyles:{fillColor:[245,247,250]},margin:{left:this.margin,right:this.margin}}),this.currentY=this.doc.lastAutoTable.finalY+10}addBuyerPersona(e){this.addHeading(e.title||e.role||"Buyer Persona",3),e.description&&this.addParagraph(e.description);let t=[];e.role&&t.push(["Role",e.role]),e.goals&&t.push(["Goals",Array.isArray(e.goals)?e.goals.join(", "):e.goals]),e.painPoints&&t.push(["Pain Points",Array.isArray(e.painPoints)?e.painPoints.join(", "):e.painPoints]),e.buyingCriteria&&t.push(["Buying Criteria",Array.isArray(e.buyingCriteria)?e.buyingCriteria.join(", "):e.buyingCriteria]),t.length>0&&this.addTable({headers:["Attribute","Details"],rows:t})}addCompanyRatingsTable(e){let t=e.map(e=>{var t;return[e.companyName||"",(null==(t=e.rating)?void 0:t.toString())||"",e.fitScore||"",e.notes||""]});this.addTable({headers:["Company","Rating","Fit Score","Notes"],rows:t})}addScoresTable(e){let t=Object.entries(e).map(e=>{let[t,a]=e;return[t.replace(/([A-Z])/g," $1").trim(),(null==a?void 0:a.toString())||""]});this.addTable({headers:["Category","Score"],rows:t})}addFinancialAnalysisTable(e){let t=[];e.investment&&t.push(["Initial Investment","$".concat(e.investment.toLocaleString())]),e.annualCost&&t.push(["Annual Cost","$".concat(e.annualCost.toLocaleString())]),e.expectedReturn&&t.push(["Expected Annual Return","$".concat(e.expectedReturn.toLocaleString())]),e.roi&&t.push(["ROI","".concat(e.roi,"%")]),e.paybackPeriod&&t.push(["Payback Period","".concat(e.paybackPeriod," months")]),this.addTable({headers:["Metric","Value"],rows:t})}addCostBreakdownTable(e){let t=e.map(e=>{var t;return[e.category||"",e.description||"","$".concat((null==(t=e.cost)?void 0:t.toLocaleString())||"0")]});this.addTable({headers:["Category","Description","Cost"],rows:t})}hexToRGB(e){let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:[0,0,0]}getBlob(){return this.doc.output("blob")}getBase64(){return this.doc.output("dataurlstring")}save(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"export.pdf";this.doc.save(e)}constructor(e={}){var t,a;this.doc=new I.uE({orientation:"portrait",unit:"mm",format:"a4"}),this.pageWidth=this.doc.internal.pageSize.getWidth(),this.pageHeight=this.doc.internal.pageSize.getHeight(),this.margin=20,this.currentY=this.margin,this.primaryColor=(null==(t=e.branding)?void 0:t.primaryColor)?this.hexToRGB(e.branding.primaryColor):[139,92,246],this.secondaryColor=(null==(a=e.branding)?void 0:a.secondaryColor)?this.hexToRGB(e.branding.secondaryColor):[59,130,246]}}var N=a(5976);class B{static async generateICPAnalysis(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new B(t);if(a.addTitlePage(t.title||"Ideal Customer Profile Analysis",t.subtitle||"Revenue Intelligence Platform"),a.addPageBreak(),a.addHeading("Executive Summary",1),a.addParagraph(e.executiveSummary||"This document provides a comprehensive analysis of your Ideal Customer Profile (ICP), including detailed buyer personas, company ratings, and market insights."),a.addSpacing(),e.sections&&Array.isArray(e.sections))for(let t of e.sections)a.addSection(t);if(e.buyerPersonas&&e.buyerPersonas.length>0)for(let t of(a.addPageBreak(),a.addHeading("Buyer Personas",1),e.buyerPersonas))a.addBuyerPersona(t);return e.companyRatings&&e.companyRatings.length>0&&(a.addPageBreak(),a.addHeading("Company Ratings",1),a.addCompanyRatingsTable(e.companyRatings)),a.generate()}static async generateAssessment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new B(t);if(a.addTitlePage(t.title||"Assessment Results",t.subtitle||"Revenue Intelligence Platform"),a.addPageBreak(),a.addHeading("Assessment Overview",1),a.addParagraph(e.overview||"This assessment provides insights into your revenue intelligence capabilities and identifies areas for improvement."),a.addSpacing(),e.scores&&(a.addHeading("Competency Scores",2),a.addScoresTable(e.scores),a.addSpacing()),e.recommendations&&e.recommendations.length>0)for(let t of(a.addHeading("Recommendations",2),e.recommendations))a.addBulletPoint(t);if(e.actionItems&&e.actionItems.length>0)for(let t of(a.addSpacing(),a.addHeading("Action Items",2),e.actionItems))a.addBulletPoint(t);return a.generate()}static async generateBusinessCase(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new B(t);if(a.addTitlePage(t.title||"Business Case",t.subtitle||e.companyName||"Investment Proposal"),a.addPageBreak(),a.addHeading("Executive Summary",1),a.addParagraph(e.executiveSummary||"This business case outlines the strategic value proposition, financial justification, and implementation roadmap for the proposed investment."),a.addSpacing(),e.problemStatement&&(a.addHeading("Problem Statement",2),a.addParagraph(e.problemStatement),a.addSpacing()),e.solution&&(a.addHeading("Proposed Solution",2),a.addParagraph(e.solution),a.addSpacing()),e.benefits&&e.benefits.length>0){for(let t of(a.addHeading("Key Benefits",2),e.benefits))a.addBulletPoint(t);a.addSpacing()}if(e.financialAnalysis&&(a.addHeading("Financial Analysis",2),a.addFinancialAnalysisTable(e.financialAnalysis),a.addSpacing()),e.roiProjections&&(a.addHeading("ROI Projections",2),a.addParagraph(e.roiProjections),a.addSpacing()),e.implementationPlan&&(a.addHeading("Implementation Plan",2),a.addParagraph(e.implementationPlan),a.addSpacing()),e.risks&&e.risks.length>0)for(let t of(a.addHeading("Risks and Mitigation",2),e.risks))a.addBulletPoint(t);return a.generate()}static async generateCostCalculator(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new B(t);return a.addTitlePage(t.title||"Cost of Inaction Analysis",t.subtitle||"Financial Impact Assessment"),a.addPageBreak(),a.addHeading("Cost Analysis Summary",1),a.addParagraph("This analysis quantifies the financial impact of maintaining the status quo versus taking action."),a.addSpacing(),e.totalCost&&(a.addKeyMetric("Total Cost of Inaction (Annual)","$".concat(e.totalCost.toLocaleString())),a.addSpacing()),e.breakdown&&e.breakdown.length>0&&(a.addHeading("Cost Breakdown",2),a.addCostBreakdownTable(e.breakdown),a.addSpacing()),e.recommendations&&(a.addHeading("Recommendations",2),a.addParagraph(e.recommendations)),a.generate()}static async generateFromSections(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new B(t);for(let s of(t.title&&(a.addTitlePage(t.title,t.subtitle),a.addPageBreak()),e))a.addSection(s);return a.generate()}addTitlePage(e,t){this.sections.push(new N.fzL({text:e,heading:N.Fmo.TITLE,alignment:N.Yus.CENTER,spacing:{before:(0,N.PBP)(2),after:(0,N.PBP)(.5)},run:{size:48,bold:!0,color:"8B5CF6"}})),t&&this.sections.push(new N.fzL({text:t,alignment:N.Yus.CENTER,spacing:{before:0,after:(0,N.PBP)(1)},run:{size:28,color:"3B82F6"}}));let a=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});this.sections.push(new N.fzL({text:a,alignment:N.Yus.CENTER,spacing:{before:(0,N.PBP)(3),after:0},run:{size:20,color:"6B7280"}})),this.sections.push(new N.fzL({text:"Generated by Revenue Intelligence Platform",alignment:N.Yus.CENTER,spacing:{before:(0,N.PBP)(.5),after:0},run:{size:18,color:"9CA3AF",italics:!0}}))}addPageBreak(){this.sections.push(new N.fzL({children:[new N.bjD]}))}addHeading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=1===t?N.Fmo.HEADING_1:2===t?N.Fmo.HEADING_2:N.Fmo.HEADING_3;this.sections.push(new N.fzL({text:e,heading:a,spacing:{before:1===t?400:300,after:1===t?200:150},run:{size:1===t?32:2===t?28:24,bold:!0,color:"8B5CF6"}}))}addParagraph(e){this.sections.push(new N.fzL({text:e,spacing:{before:100,after:100,line:360},run:{size:22}}))}addBulletPoint(e){this.sections.push(new N.fzL({text:e,bullet:{level:0},spacing:{before:50,after:50,line:320},run:{size:22}}))}addKeyMetric(e,t){this.sections.push(new N.fzL({text:e,spacing:{before:200,after:50},run:{size:20,bold:!0,color:"6B7280"}})),this.sections.push(new N.fzL({text:t,spacing:{before:0,after:200},run:{size:32,bold:!0,color:"8B5CF6"}}))}addSpacing(){this.sections.push(new N.fzL({text:"",spacing:{before:200,after:200}}))}addSection(e){if(this.addHeading(e.title,2),"string"==typeof e.content)this.addParagraph(e.content);else if(Array.isArray(e.content))for(let t of e.content)this.addBulletPoint(t);"table"===e.type&&e.data&&this.addTable(e.data),this.addSpacing()}addTable(e){let t=[];for(let a of(t.push(new N.Hjg({children:e.headers.map(e=>new N.nA6({children:[new N.fzL({text:e,run:{bold:!0,size:20,color:"FFFFFF"}})],shading:{fill:"8B5CF6",type:N.DB2.SOLID,color:"8B5CF6"}})),tableHeader:!0})),e.rows))t.push(new N.Hjg({children:a.map(e=>new N.nA6({children:[new N.fzL({text:e,run:{size:20}})]}))}));this.sections.push(new N.XIK({rows:t,width:{size:100,type:N.PsV.PERCENTAGE},borders:{top:{style:N.kDD.SINGLE,size:1,color:"CCCCCC"},bottom:{style:N.kDD.SINGLE,size:1,color:"CCCCCC"},left:{style:N.kDD.SINGLE,size:1,color:"CCCCCC"},right:{style:N.kDD.SINGLE,size:1,color:"CCCCCC"},insideHorizontal:{style:N.kDD.SINGLE,size:1,color:"E5E7EB"},insideVertical:{style:N.kDD.SINGLE,size:1,color:"E5E7EB"}}})),this.addSpacing()}addBuyerPersona(e){this.addHeading(e.title||e.role||"Buyer Persona",3),e.description&&this.addParagraph(e.description);let t=[];if(e.role&&t.push(["Role",e.role]),e.goals){let a=Array.isArray(e.goals)?e.goals.join(", "):e.goals;t.push(["Goals",a])}if(e.painPoints){let a=Array.isArray(e.painPoints)?e.painPoints.join(", "):e.painPoints;t.push(["Pain Points",a])}if(e.buyingCriteria){let a=Array.isArray(e.buyingCriteria)?e.buyingCriteria.join(", "):e.buyingCriteria;t.push(["Buying Criteria",a])}t.length>0&&this.addTable({headers:["Attribute","Details"],rows:t})}addCompanyRatingsTable(e){let t=e.map(e=>{var t;return[e.companyName||"",(null==(t=e.rating)?void 0:t.toString())||"",e.fitScore||"",e.notes||""]});this.addTable({headers:["Company","Rating","Fit Score","Notes"],rows:t})}addScoresTable(e){let t=Object.entries(e).map(e=>{let[t,a]=e;return[t.replace(/([A-Z])/g," $1").trim(),(null==a?void 0:a.toString())||""]});this.addTable({headers:["Category","Score"],rows:t})}addFinancialAnalysisTable(e){let t=[];e.investment&&t.push(["Initial Investment","$".concat(e.investment.toLocaleString())]),e.annualCost&&t.push(["Annual Cost","$".concat(e.annualCost.toLocaleString())]),e.expectedReturn&&t.push(["Expected Annual Return","$".concat(e.expectedReturn.toLocaleString())]),e.roi&&t.push(["ROI","".concat(e.roi,"%")]),e.paybackPeriod&&t.push(["Payback Period","".concat(e.paybackPeriod," months")]),this.addTable({headers:["Metric","Value"],rows:t})}addCostBreakdownTable(e){let t=e.map(e=>{var t;return[e.category||"",e.description||"","$".concat((null==(t=e.cost)?void 0:t.toLocaleString())||"0")]});this.addTable({headers:["Category","Description","Cost"],rows:t})}async generate(){let e=new N.yoT({creator:this.options.author||"Revenue Intelligence Platform",title:this.options.title||"Export Document",description:this.options.description||"Generated document",sections:[{properties:{},children:this.sections}]});return await N.ND6.toBlob(e)}static async saveToFile(e,t){let a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"icp";switch(s){case"icp":a=await B.generateICPAnalysis(e);break;case"assessment":a=await B.generateAssessment(e);break;case"businessCase":a=await B.generateBusinessCase(e);break;case"cost":a=await B.generateCostCalculator(e)}let i=window.URL.createObjectURL(a),r=document.createElement("a");r.href=i,r.download=t.endsWith(".docx")?t:"".concat(t,".docx"),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(i)}constructor(e={}){this.sections=[],this.options=e}}class k{getSupportedFormats(){return[{format:"pdf",name:"PDF Document",description:"Portable Document Format - ideal for reports and presentations",mimeType:"application/pdf",extension:".pdf",supportedTypes:["assessment","icp","cost","business_case","comprehensive"]},{format:"docx",name:"Word Document",description:"Microsoft Word format - editable and professional",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",extension:".docx",supportedTypes:["assessment","icp","cost","business_case","comprehensive"]},{format:"pptx",name:"PowerPoint Presentation",description:"Microsoft PowerPoint format - perfect for presentations",mimeType:"application/vnd.openxmlformats-officedocument.presentationml.presentation",extension:".pptx",supportedTypes:["icp","business_case","comprehensive"]},{format:"csv",name:"CSV Data",description:"Comma-separated values - ideal for data analysis",mimeType:"text/csv",extension:".csv",supportedTypes:["assessment","icp","cost","progress"]},{format:"json",name:"JSON Data",description:"JavaScript Object Notation - structured data format",mimeType:"application/json",extension:".json",supportedTypes:["assessment","icp","cost","business_case","progress"]},{format:"xlsx",name:"Excel Spreadsheet",description:"Microsoft Excel format - perfect for data analysis",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",extension:".xlsx",supportedTypes:["assessment","icp","cost","progress"]}]}async exportData(e){try{let t;console.log("\uD83D\uDCE4 Exporting data:",e.type,"as",e.format);let a=this.validateExportRequest(e);if(!a.valid)return{success:!1,error:"Validation failed: ".concat(a.errors.join(", "))};let s="export_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),i=Date.now(),r=null;"pdf"===e.format?r=await this.generatePDF(e):"docx"===e.format&&(r=await this.generateDOCX(e)),t=r?URL.createObjectURL(r):"/api/exports/".concat(s,"/download");let o={exportId:s,status:"completed",downloadUrl:t,fileSize:r?r.size:this.estimateFileSize(e),expiresAt:new Date(Date.now()+6048e5).toISOString(),metadata:{format:e.format,type:e.type,generatedAt:new Date().toISOString(),processingTime:Date.now()-i}};return{success:!0,data:o}}catch(e){return console.error("❌ Export failed:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async generatePDF(e){let{type:t,data:a,options:s}=e,i={title:(null==s?void 0:s.template)||"".concat(t," Export"),subtitle:"Revenue Intelligence Platform",author:"Revenue Intelligence Platform",includeHeader:!0,includeFooter:!0,...s};switch(t){case"icp":return await A.generateICPAnalysis(a,i);case"assessment":return await A.generateAssessment(a,i);case"business_case":return await A.generateBusinessCase(a,i);case"cost":return await A.generateCostCalculator(a,i);case"comprehensive":return await A.generateFromSections(a.sections||[],i);default:throw Error("PDF generation not supported for type: ".concat(t))}}async generateDOCX(e){let{type:t,data:a,options:s}=e,i={title:(null==s?void 0:s.template)||"".concat(t," Export"),subtitle:"Revenue Intelligence Platform",author:"Revenue Intelligence Platform",...s};switch(t){case"icp":return await B.generateICPAnalysis(a,i);case"assessment":return await B.generateAssessment(a,i);case"business_case":return await B.generateBusinessCase(a,i);case"cost":return await B.generateCostCalculator(a,i);case"comprehensive":return await B.generateFromSections(a.sections||[],i);default:throw Error("DOCX generation not supported for type: ".concat(t))}}async getExportStatus(e){try{console.log("\uD83D\uDCCA Checking export status from database:",e);let{data:t,error:a}=await S.ND.from("export_history").select("*").eq("id",e).single();if(a)return console.error("❌ Supabase error:",a),{success:!1,error:a.message||"Failed to retrieve export status"};if(!t)return{success:!1,error:"Export not found"};let s={exportId:t.id,status:t.status||"completed",downloadUrl:t.download_url,fileSize:t.file_size,expiresAt:t.expires_at,metadata:{format:t.format||"pdf",type:t.type||"assessment",generatedAt:t.generated_at||t.created_at,processingTime:t.processing_time||0}};return console.log("✅ Export status retrieved successfully"),{success:!0,data:s}}catch(e){return console.error("❌ Failed to get export status:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async downloadExport(e){try{console.log("⬇️ Downloading export from database:",e);let{data:t,error:a}=await S.ND.from("export_history").select("*").eq("id",e).single();if(a)return console.error("❌ Supabase error:",a),{success:!1,error:a.message||"Failed to retrieve export"};if(!t)return{success:!1,error:"Export not found"};if(t.expires_at&&new Date(t.expires_at)<new Date)return{success:!1,error:"Export has expired"};let s="export_".concat(e,".").concat(t.format||"pdf");return console.log("✅ Export download info retrieved successfully"),{success:!0,data:{downloadUrl:t.download_url||"/api/exports/".concat(e,"/download"),filename:s}}}catch(e){return console.error("❌ Failed to download export:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async getExportHistory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;try{console.log("\uD83D\uDCCB Fetching export history from database for customer:",e);let{data:a,error:s}=await S.ND.from("export_history").select("*").eq("user_id",e).order("created_at",{ascending:!1}).limit(t);if(s)return console.error("❌ Supabase error:",s),{success:!1,error:s.message||"Failed to retrieve export history"};let i=(a||[]).map(e=>({exportId:e.id,status:e.status||"completed",downloadUrl:e.download_url,fileSize:e.file_size,expiresAt:e.expires_at,metadata:{format:e.format||"pdf",type:e.type||"assessment",generatedAt:e.generated_at||e.created_at,processingTime:e.processing_time||0}}));return console.log("✅ Retrieved ".concat(i.length," exports from database")),{success:!0,data:i}}catch(e){return console.error("❌ Failed to fetch export history:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async deleteExport(e){try{console.log("\uD83D\uDDD1️ Deleting export from database:",e);let{error:t}=await S.ND.from("export_history").delete().eq("id",e);if(t)return console.error("❌ Supabase error:",t),{success:!1,error:t.message||"Failed to delete export"};return console.log("✅ Export deleted successfully"),{success:!0,message:"Export deleted successfully"}}catch(e){return console.error("❌ Failed to delete export:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}validateExportRequest(e){var t,a;let s=[];(null==(t=e.type)?void 0:t.trim())||s.push("Export type is required"),(null==(a=e.format)?void 0:a.trim())||s.push("Export format is required"),e.data||s.push("Export data is required");let i=this.getSupportedFormats().find(t=>t.format===e.format);return i?i.supportedTypes.includes(e.type)||s.push("Format ".concat(e.format," is not supported for type ").concat(e.type)):s.push("Unsupported format: ".concat(e.format)),{valid:0===s.length,errors:s}}estimateFileSize(e){return Math.round(({pdf:5e5,docx:3e5,pptx:8e5,csv:5e4,json:1e5,xlsx:2e5}[e.format]||1e5)*(({assessment:1,icp:1.5,cost:1.2,business_case:2,comprehensive:3,progress:.8})[e.type]||1))}getExportTemplates(){return[{id:"assessment_report",name:"Assessment Report",description:"Comprehensive assessment results with insights and recommendations",type:"assessment",format:"pdf"},{id:"icp_analysis",name:"ICP Analysis Report",description:"Detailed Ideal Customer Profile analysis with buyer personas",type:"icp",format:"docx"},{id:"cost_analysis",name:"Cost Analysis Report",description:"Cost of inaction analysis with financial projections",type:"cost",format:"pdf"},{id:"business_case",name:"Business Case Document",description:"Professional business case with ROI analysis and implementation plan",type:"business_case",format:"docx"},{id:"executive_summary",name:"Executive Summary",description:"High-level summary for executive presentation",type:"comprehensive",format:"pptx"}]}async getExportStatistics(e){try{return console.log("\uD83D\uDCCA Fetching export statistics"),{success:!0,data:{totalExports:156,formatBreakdown:{pdf:45,docx:38,pptx:22,csv:28,json:15,xlsx:8},typeBreakdown:{assessment:52,icp:34,cost:28,business_case:25,comprehensive:12,progress:5}}}}catch(e){return console.error("❌ Failed to fetch export statistics:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}constructor(){this.baseUrl="https://hs-andru-test.onrender.com",this.apiKey=w.backendApiKey||""}}let R=new k,L=[{id:"PDF",name:"PDF Document",description:"Portable document format",icon:n.A,color:"text-red-600 bg-red-50 hover:bg-red-100"},{id:"DOCX",name:"Word Document",description:"Editable document format",icon:h.A,color:"text-blue-600 bg-blue-50 hover:bg-blue-100"},{id:"JSON",name:"JSON Data",description:"Structured data format",icon:u.A,color:"text-green-600 bg-green-50 hover:bg-green-100"},{id:"CSV",name:"CSV Spreadsheet",description:"Tabular data format",icon:m.A,color:"text-purple-600 bg-purple-50 hover:bg-purple-100"}],j=e=>{let{resource:t,onExport:a,isLoading:n=!1}=e,[c,l]=(0,i.useState)(!1),[d,p]=(0,i.useState)(null),g=async e=>{p(e),l(!1);try{let s={type:"resource",data:{resource:t,content:t.content||"Resource content not available",metadata:{title:t.title,description:t.description,category:t.category,tier:t.tier,lastUpdated:t.lastUpdated}},format:e.toLowerCase(),options:{includeMetadata:!0,customStyling:!0}},i=await R.exportData(s);if(i.success&&i.downloadUrl){let a=document.createElement("a");a.href=i.downloadUrl,a.download="".concat(t.title.replace(/\s+/g,"_"),".").concat(e.toLowerCase()),document.body.appendChild(a),a.click(),document.body.removeChild(a)}else throw Error(i.error||"Export failed");await a(t,e)}catch(e){console.error("Export failed:",e)}finally{p(null)}},h=L.filter(e=>t.exportFormats.includes(e.id));return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("button",{onClick:()=>l(!c),disabled:n||null!==d,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:d?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.A,{className:"h-4 w-4 animate-spin"}),"Exporting ",d,"..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(y.A,{className:"h-4 w-4"}),"Export",(0,s.jsx)(P.A,{className:"h-4 w-4"})]})}),(0,s.jsx)(r.N,{children:c&&(0,s.jsx)(o.P.div,{initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},className:"absolute right-0 top-full mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-10",children:(0,s.jsxs)("div",{className:"p-2",children:[(0,s.jsx)("div",{className:"px-3 py-2 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Export Formats"}),h.map(e=>{let t=e.icon,a=d===e.id;return(0,s.jsxs)("button",{onClick:()=>g(e.id),disabled:n||a,className:"\n                      w-full flex items-center gap-3 px-3 py-2 rounded-md text-sm transition-colors\n                      ".concat(e.color,"\n                      ").concat(a?"opacity-50 cursor-not-allowed":"cursor-pointer","\n                    "),children:[a?(0,s.jsx)(f.A,{className:"h-4 w-4 animate-spin"}):(0,s.jsx)(t,{className:"h-4 w-4"}),(0,s.jsxs)("div",{className:"flex-1 text-left",children:[(0,s.jsx)("div",{className:"font-medium",children:e.name}),(0,s.jsx)("div",{className:"text-xs opacity-75",children:e.description})]})]},e.id)}),0===h.length&&(0,s.jsx)("div",{className:"px-3 py-4 text-sm text-gray-500 text-center",children:"No export formats available"})]})})}),c&&(0,s.jsx)("div",{className:"fixed inset-0 z-0",onClick:()=>l(!1)})]})},F=e=>{let{resource:t,isOpen:a,onClose:i,onExport:h,onShare:u,isLoading:m=!1}=e;if(!t)return null;let f=(t.category,"# ".concat(t.title,"\n\n## Overview\n").concat(t.description,"\n\n## Content Loading\nThis resource content will be loaded from the API based on the resource type and user's access level.\n\n## Status\n").concat("available"===t.status?"Available for download":"locked"===t.status?"Locked - complete prerequisites to unlock":"Generating content...","\n\n## Export Formats\n").concat(t.exportFormats.join(", "),"\n"));return(0,s.jsx)(r.N,{children:a&&(0,s.jsxs)(o.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:i}),(0,s.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,s.jsxs)(o.P.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"relative w-full max-w-6xl bg-white rounded-lg shadow-xl",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(n.A,{className:"h-6 w-6 text-blue-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:t.title}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:t.description})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{onClick:()=>u(t),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",title:"Share resource",children:(0,s.jsx)(c.A,{className:"h-5 w-5"})}),(0,s.jsx)("button",{onClick:i,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:(0,s.jsx)(l.A,{className:"h-5 w-5"})})]})]}),(0,s.jsx)("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:(0,s.jsx)("div",{className:"prose prose-sm max-w-none",children:(0,s.jsx)("pre",{className:"whitespace-pre-wrap font-sans text-sm text-gray-700 leading-relaxed",children:f})})}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(d.A,{className:"h-4 w-4"}),"Updated ",t.lastUpdated]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(p.A,{className:"h-4 w-4"}),t.accessCount," views"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("button",{onClick:()=>{navigator.clipboard.writeText(f)},className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-800 transition-colors",children:[(0,s.jsx)(g.A,{className:"h-4 w-4"}),"Copy"]}),(0,s.jsx)(j,{resource:t,onExport:h,isLoading:m})]})]})]})})]})})}},68542:(e,t,a)=>{a.d(t,{ND:()=>s.ND});var s=a(23395)}}]);