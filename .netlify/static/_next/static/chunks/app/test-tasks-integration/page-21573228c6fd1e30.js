(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8123],{23395:(e,s,r)=>{"use strict";r.d(s,{ND:()=>n});var t=r(23171);let a="https://molcqjsqtjbfclasynpg.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1vbGNxanNxdGpiZmNsYXN5bnBnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODk1NDcsImV4cCI6MjA3MTQ2NTU0N30.IEP7E2VM2uV1vltbSw1CwYpYw1qw6MvI-JB5SD0tUKI";if(!a||!l)throw Error("Missing Supabase environment variables. Please check NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY");let n=(0,t.UU)(a,l,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})},34477:(e,s,r)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),!function(e,s){for(var r in s)Object.defineProperty(e,r,{enumerable:!0,get:s[r]})}(s,{callServer:function(){return t.callServer},createServerReference:function(){return l.createServerReference},findSourceMapURL:function(){return a.findSourceMapURL}});let t=r(53806),a=r(31818),l=r(77197)},35604:(e,s,r)=>{"use strict";r.d(s,{A:()=>l});var t=r(12115),a=r(68542);function l(){var e,s;let[r,l]=(0,t.useState)({user:null,session:null,loading:!0,error:null});(0,t.useEffect)(()=>{let e=!0;(async()=>{try{let{data:{session:r},error:t}=await a.ND.auth.getSession();if(t){console.error("Error getting session:",t),e&&l(e=>({...e,error:t.message,loading:!1}));return}if(e){var s;l({user:null!=(s=null==r?void 0:r.user)?s:null,session:r,loading:!1,error:null})}}catch(s){console.error("Auth initialization error:",s),e&&l(e=>({...e,error:"Failed to initialize authentication",loading:!1}))}})();let{data:{subscription:s}}=a.ND.auth.onAuthStateChange(async(s,r)=>{var t,a;if(e)switch(console.log("Auth state changed:",s),l({user:null!=(t=null==r?void 0:r.user)?t:null,session:r,loading:!1,error:null}),s){case"SIGNED_IN":console.log("User signed in:",null==r||null==(a=r.user)?void 0:a.email);break;case"SIGNED_OUT":console.log("User signed out");break;case"TOKEN_REFRESHED":console.log("Token refreshed");break;case"USER_UPDATED":console.log("User updated")}});return()=>{e=!1,s.unsubscribe()}},[]);let n=async(e,s)=>{try{l(e=>({...e,error:null}));let{data:r,error:t}=await a.ND.auth.signInWithPassword({email:e,password:s});if(t)return l(e=>({...e,error:t.message})),{success:!1,error:t.message};return{success:!0}}catch(s){let e=(null==s?void 0:s.message)||"Sign in failed";return l(s=>({...s,error:e})),{success:!1,error:e}}},i=async function(e,s){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{l(e=>({...e,error:null}));let{data:t,error:n}=await a.ND.auth.signUp({email:e,password:s,options:{data:r}});if(n)return l(e=>({...e,error:n.message})),{success:!1,error:n.message};return{success:!0}}catch(s){let e=(null==s?void 0:s.message)||"Sign up failed";return l(s=>({...s,error:e})),{success:!1,error:e}}},o=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/dashboard";try{l(e=>({...e,error:null}));let{data:s,error:r}=await a.ND.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/api/auth/callback?next=").concat(encodeURIComponent(e))}});if(r)return l(e=>({...e,error:r.message})),{success:!1,error:r.message};return{success:!0}}catch(s){let e=(null==s?void 0:s.message)||"Google sign in failed";return l(s=>({...s,error:e})),{success:!1,error:e}}},c=async()=>{try{l(e=>({...e,error:null}));let{error:e}=await a.ND.auth.signOut();if(e)return l(s=>({...s,error:e.message})),{success:!1,error:e.message};return{success:!0}}catch(s){let e=(null==s?void 0:s.message)||"Sign out failed";return l(s=>({...s,error:e})),{success:!1,error:e}}},d=async e=>{try{l(e=>({...e,error:null}));let{error:s}=await a.ND.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/reset-password")});if(s)return l(e=>({...e,error:s.message})),{success:!1,error:s.message};return{success:!0}}catch(s){let e=(null==s?void 0:s.message)||"Password reset failed";return l(s=>({...s,error:e})),{success:!1,error:e}}},u=async e=>{try{l(e=>({...e,error:null}));let{error:s}=await a.ND.auth.updateUser({password:e});if(s)return l(e=>({...e,error:s.message})),{success:!1,error:s.message};return{success:!0}}catch(s){let e=(null==s?void 0:s.message)||"Password update failed";return l(s=>({...s,error:e})),{success:!1,error:e}}},m=!!r.session,p=(null==(s=r.user)||null==(e=s.app_metadata)?void 0:e.role)==="admin";return{...r,signInWithEmail:n,signUpWithEmail:i,signInWithGoogle:o,signOut:c,resetPassword:d,updatePassword:u,getUserMetadata:()=>{var e,s,t,a,l;return{...null==(e=r.user)?void 0:e.user_metadata,email:null==(s=r.user)?void 0:s.email,id:null==(t=r.user)?void 0:t.id,role:null==(l=r.user)||null==(a=l.app_metadata)?void 0:a.role}},isAuthenticated:m,isAdmin:p}}},47718:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>c});var t=r(95155),a=r(12115),l=r(30290),n=r(47456),i=r(94883),o=r(35604);function c(){let{user:e,isAuthenticated:s}=(0,o.A)(),[r,c]=(0,a.useState)([]),[d,u]=(0,a.useState)(!1),[m,p]=(0,a.useState)(null),[h,g]=(0,a.useState)(""),[x,N]=(0,a.useState)({customerAnalysis:50,valueCommunication:50,executiveReadiness:50}),v=async()=>{if(!(null==e?void 0:e.id))return void p("User not authenticated");u(!0),p(null);try{let s={customerId:e.id,milestone:{tier:"foundation",taskTableSource:"seed"},competencyScores:x};console.log("Fetching tasks for customer:",s);let r=await (0,l.w)(s);console.log("Tasks fetched:",r),c(r)}catch(e){console.error("Error fetching tasks:",e),p(e.message||"Failed to fetch tasks")}finally{u(!1)}},b=async s=>{if(!(null==e?void 0:e.id))return void p("User not authenticated");try{var r;g("Completing task: ".concat(s.name,"..."));let t=await i.A.trackTaskCompletion({taskId:s.id,taskName:s.name,customerId:e.id,competencyArea:s.competencyArea,priority:s.priority,milestone:"foundation",toolUsed:(null==(r=s.platformConnection)?void 0:r.tool)||"none",notes:"Completed via test page",competencyGain:5});console.log("Task completed:",t),g("✅ Task completed successfully!");let a=i.A.getCurrentCompetencyScores();N(a),setTimeout(()=>v(),1e3)}catch(e){console.error("Error completing task:",e),g("❌ Error: ".concat(e.message))}};return(0,a.useEffect)(()=>{s&&(null==e?void 0:e.id)&&(v(),N(i.A.getCurrentCompetencyScores()))},[s,null==e?void 0:e.id]),(0,a.useEffect)(()=>{let e=async e=>{let s=e.detail;try{await (0,n.Y)(s.customerId,{id:s.taskId,name:s.taskName,competencyArea:s.competencyArea,priority:s.priority,category:s.milestone},{toolUsed:s.toolUsed,notes:s.notes||"Completed via ".concat(s.platform),competencyGain:s.competencyGain}),console.log("✅ Task completion persisted to Supabase")}catch(e){console.error("❌ Failed to persist task completion:",e)}};return window.addEventListener("taskCompletionPersist",e),()=>window.removeEventListener("taskCompletionPersist",e)},[]),(0,t.jsx)("div",{className:"min-h-screen bg-gray-900 text-white p-8",children:(0,t.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"\uD83E\uDDEA Tasks System Integration Test"}),(0,t.jsx)("p",{className:"text-gray-400",children:"Testing TaskDataService + TaskCompletionService + Supabase"})]}),(0,t.jsxs)("div",{className:"bg-gray-800 p-6 rounded-lg mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Authentication Status"}),s?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-green-400",children:"✅ Authenticated"}),(0,t.jsxs)("p",{className:"text-gray-300",children:["User ID: ",null==e?void 0:e.id]}),(0,t.jsxs)("p",{className:"text-gray-300",children:["Email: ",null==e?void 0:e.email]})]}):(0,t.jsx)("p",{className:"text-red-400",children:"❌ Not authenticated - Please log in"})]}),(0,t.jsxs)("div",{className:"bg-gray-800 p-6 rounded-lg mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Current Competency Scores"}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-400 text-sm",children:"Customer Analysis"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-purple-400",children:x.customerAnalysis})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-400 text-sm",children:"Value Communication"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-blue-400",children:x.valueCommunication})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-400 text-sm",children:"Executive Readiness"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-green-400",children:x.executiveReadiness})]})]})]}),(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)("button",{onClick:v,disabled:d||!s,className:"bg-purple-600 hover:bg-purple-500 disabled:bg-gray-700 disabled:cursor-not-allowed px-6 py-3 rounded-lg font-semibold transition-colors",children:d?"Fetching Tasks...":"Fetch Tasks from Supabase"})}),m&&(0,t.jsx)("div",{className:"bg-red-900/20 border border-red-500 p-4 rounded-lg mb-6",children:(0,t.jsxs)("p",{className:"text-red-400",children:["❌ Error: ",m]})}),h&&(0,t.jsx)("div",{className:"bg-blue-900/20 border border-blue-500 p-4 rounded-lg mb-6",children:(0,t.jsx)("p",{className:"text-blue-400",children:h})}),(0,t.jsxs)("div",{className:"bg-gray-800 p-6 rounded-lg",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold mb-4",children:["Fetched Tasks (",r.length,")"]}),0===r.length&&!d&&(0,t.jsx)("p",{className:"text-gray-400",children:'No tasks found. Click "Fetch Tasks" to load.'}),(0,t.jsx)("div",{className:"space-y-4",children:r.map(e=>(0,t.jsxs)("div",{className:"bg-gray-700 p-4 rounded-lg border border-gray-600",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:e.name}),(0,t.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:e.description})]}),(0,t.jsx)("span",{className:"px-3 py-1 rounded text-xs font-semibold ".concat("critical"===e.priority?"bg-red-600 text-white":"high"===e.priority?"bg-orange-600 text-white":"medium"===e.priority?"bg-yellow-600 text-white":"bg-gray-600 text-white"),children:e.priority})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-3 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Category:"})," ",(0,t.jsx)("span",{className:"text-white",children:e.category})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Competency Area:"})," ",(0,t.jsx)("span",{className:"text-white",children:e.competencyArea})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Estimated Time:"})," ",(0,t.jsx)("span",{className:"text-white",children:e.estimatedTime})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Stage/Milestone:"})," ",(0,t.jsx)("span",{className:"text-white",children:e.stageMilestone})]})]}),e.platformConnection&&(0,t.jsxs)("div",{className:"mt-3 p-3 bg-purple-900/30 rounded border border-purple-500/50",children:[(0,t.jsxs)("p",{className:"text-sm text-purple-300",children:["\uD83D\uDD17 Platform Tool: ",(0,t.jsx)("span",{className:"font-semibold",children:e.platformConnection.tool})]}),(0,t.jsx)("p",{className:"text-xs text-purple-400 mt-1",children:e.platformConnection.description})]}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)("button",{onClick:()=>b(e),className:"bg-green-600 hover:bg-green-500 px-4 py-2 rounded text-sm font-semibold transition-colors",children:"✅ Mark as Complete"})})]},e.id))})]})]})})}},68542:(e,s,r)=>{"use strict";r.d(s,{ND:()=>t.ND});var t=r(23395)},85237:(e,s,r)=>{Promise.resolve().then(r.bind(r,47718))}},e=>{e.O(0,[4134,3171,7919,8441,5964,7358],()=>e(e.s=85237)),_N_E=e.O()}]);