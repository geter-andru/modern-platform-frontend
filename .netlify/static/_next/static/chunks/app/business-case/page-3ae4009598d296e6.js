(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5220],{14152:(e,r,t)=>{Promise.resolve().then(t.bind(t,56563))},35695:(e,r,t)=>{"use strict";var s=t(18999);t.o(s,"useParams")&&t.d(r,{useParams:function(){return s.useParams}}),t.o(s,"usePathname")&&t.d(r,{usePathname:function(){return s.usePathname}}),t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(r,{useSearchParams:function(){return s.useSearchParams}})},56563:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var s=t(95155),n=t(12115),a=t(35695),u=t(68542);let o={async isAuthenticated(){try{let{data:{session:e},error:r}=await u.ND.auth.getSession();return!r&&!!e}catch(e){return console.error("Auth check failed:",e),!1}},async getCustomerId(){try{let{data:{session:e},error:r}=await u.ND.auth.getSession();if(!r&&(null==e?void 0:e.user))return e.user.id;return null}catch(e){return console.error("Failed to get customer ID:",e),null}},async getCurrentUser(){try{let{data:{session:r},error:t}=await u.ND.auth.getSession();if(!t&&(null==r?void 0:r.user)){var e;return{id:r.user.id,email:r.user.email,name:(null==(e=r.user.user_metadata)?void 0:e.name)||r.user.email,isSupabaseUser:!0}}return null}catch(e){return console.error("Failed to get current user:",e),null}}};t(87354),t(22153);var l=t(84806);function c(){let e=(0,a.useRouter)(),[r,t]=(0,n.useState)(null),[u,c]=(0,n.useState)(),[i,d]=(0,n.useState)(!0);return((0,n.useEffect)(()=>{(async()=>{let r=await o.isAuthenticated(),s=await o.getCustomerId(),n=await o.getCurrentUser();s&&r?(c(s),t(n),d(!1)):e.push("/login")})()},[e]),i)?(0,s.jsx)("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 border-2 border-green-400 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-400",children:"Loading business case builder..."})]})}):u&&r?(0,s.jsx)(l.A,{customerId:u,customerData:r}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-red-400 mb-4",children:"Failed to load customer data"}),(0,s.jsx)("button",{onClick:()=>e.push("/login"),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Back to Login"})]})})}},87354:(e,r,t)=>{"use strict";t.d(r,{EK:()=>g,NT:()=>h,Uv:()=>c,W8:()=>d,cN:()=>l,gG:()=>i,h_:()=>p,in:()=>v,lH:()=>f,p1:()=>y,ze:()=>m});var s=t(32960),n=t(5041),a=t(26715),u=t(13568),o=t(2676);function l(e){return(0,s.I)({queryKey:["customer",e],queryFn:()=>o.FH.getCustomer(e),enabled:!!e})}function c(e){return(0,s.I)({queryKey:["customer-icp",e],queryFn:()=>o.FH.getCustomerICP(e),enabled:!!e})}function i(){return(0,n.n)({mutationFn:o.FH.calculateCost,onSuccess:()=>{u.Ay.success("Cost calculation completed!")},onError:e=>{var r,t;u.Ay.error((null==(t=e.response)||null==(r=t.data)?void 0:r.error)||"Cost calculation failed")}})}function d(){return(0,n.n)({mutationFn:o.FH.calculateCostWithAI,onSuccess:()=>{u.Ay.success("AI-enhanced cost calculation completed!")},onError:e=>{var r,t;u.Ay.error((null==(t=e.response)||null==(r=t.data)?void 0:r.error)||"AI cost calculation failed")}})}function m(e){return(0,s.I)({queryKey:["cost-history",e],queryFn:()=>o.FH.getCostCalculationHistory(e),enabled:!!e})}function y(e){return(0,s.I)({queryKey:["progress",e],queryFn:()=>o.FH.getCustomerProgress(e),enabled:!!e,refetchInterval:3e4})}function h(e){return(0,s.I)({queryKey:["milestones",e],queryFn:()=>o.FH.getMilestones(e),enabled:!!e})}function g(e){return(0,s.I)({queryKey:["progress-insights",e],queryFn:()=>o.FH.getProgressInsights(e),enabled:!!e})}function p(){let e=(0,a.jE)();return(0,n.n)({mutationFn:e=>{let{customerId:r,action:t,metadata:s}=e;return o.FH.trackProgress(r,t,s)},onSuccess:(r,t)=>{var s;e.invalidateQueries({queryKey:["progress",t.customerId]}),e.invalidateQueries({queryKey:["milestones",t.customerId]}),(null==(s=r.data.milestonesTriggered)?void 0:s.length)>0&&u.Ay.success("Milestone achieved: ".concat(r.data.milestonesTriggered[0].name,"!"),{duration:5e3,icon:"\uD83C\uDF89"})}})}function f(){let e=(0,a.jE)();return(0,n.n)({mutationFn:e=>{let{customerId:r,milestoneId:t,metadata:s}=e;return o.FH.completeMilestone(r,t,s)},onSuccess:(r,t)=>{e.invalidateQueries({queryKey:["progress",t.customerId]}),e.invalidateQueries({queryKey:["milestones",t.customerId]}),u.Ay.success("Milestone completed!")},onError:e=>{var r,t;u.Ay.error((null==(t=e.response)||null==(r=t.data)?void 0:r.error)||"Failed to complete milestone")}})}function v(){return(0,n.n)({mutationFn:e=>{let{type:r,data:t}=e;switch(r){case"icp":return o.FH.exportICP(t);case"cost-calculator":return o.FH.exportCostCalculator(t);case"business-case":return o.FH.exportBusinessCase(t);case"comprehensive":return o.FH.exportComprehensive(t);default:throw Error("Invalid export type")}},onSuccess:e=>{u.Ay.success("Export initiated successfully!"),e.data.downloadUrl&&window.open(e.data.downloadUrl,"_blank")},onError:e=>{var r,t;u.Ay.error((null==(t=e.response)||null==(r=t.data)?void 0:r.error)||"Export failed")}})}}},e=>{e.O(0,[8274,4134,3171,3568,3860,736,2676,482,511,3926,8441,5964,7358],()=>e(e.s=14152)),_N_E=e.O()}]);